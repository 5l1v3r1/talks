# Exploiting CVE-2018-11235 in Kubernetes

This demonstrates how a vulnerability in a dependency of the control plane can lead to container escape.

## Server setup

You will need a `git` server to host the repository containing the exploit (Github, Gitlab, etc block these type of repositories).

To create a server you can use the following Dockerfile. It does require the apache2.conf file as well.

Hosted gist: [https://gist.github.com/staaldraad/550fa7e3c2c19a5c281596837a3b7547](https://gist.github.com/staaldraad/550fa7e3c2c19a5c281596837a3b7547)

To use:

```bash
docker build . -t git:http
docker run -it -p 8000:80 git:http
```

Setup the repository with your exploit as outlined in [https://staaldraad.github.io/post/2018-06-03-cve-2018-11235-git-rce/](https://staaldraad.github.io/post/2018-06-03-cve-2018-11235-git-rce/)

## Exploit

To exploit this you will need a kubernetes cluster. The easiest is to [setup a minikube instance](https://kubernetes.io/docs/tasks/tools/install-minikube/) (these were still vulnerable by default when last tested).
 
Modify the `gitrepo_demo.yml` so that the `repository` option points to your git server and the correct repository.

Create the new pod:

```bash
kubectl create -f gitrepo_demo.yml
```